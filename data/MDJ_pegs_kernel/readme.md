# MDJ forward data 
Directory contains the input and output data for the forward simulation used to compute
sensitivity kernels for PEGS. The raw specfem output files are generated by running
a forward simulation with the files stored in `input`.

Note that you will also need to set the following in the constants.in before compiling specfem:

```fortran
    logical, parameter :: ASSUME_PERFECT_SPHERE = .false.
    logical, parameter :: FIX_NSTEPS_TO_CUSTOM_VALUE = .true. 
    integer, parameter :: NSTEP_CUSTOM_CONSTANT = 870
```
It is also worth noting that with a different NEX the NSTEP will likely vary. 


The directories `{chl}acc` and `{chl}grad` hold sac files of the acceleration and gravity
before and after processing using the sac macro. The sac files are produced 
using `processing/specfem_to_sac.py`. To process the sac files you can then use the 
sac macro `processing/sac_macros/macro_pegs`. Once run in each directory the processed sac files will hold the pegs acceleration and gravity components. 

These pegs signals are processed using `kernels/adjoint_source/gen_pegs_adj_src_and_plot.py` to generate the adjoint source files, which are saved in the `adj_source` directory. 

